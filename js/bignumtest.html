<html>
<body>

<script src="bignum.js"></script>
<script src="bignum_add.js"></script>
<script src="bignum_sub.js"></script>
<script src="bignum_mul.js"></script>
<script src="bignum_div.js"></script>
<script src="bignum_mod.js"></script>
<script src="bignum_pow.js"></script>
<script src="bignum_root.js"></script>
<script src="bignum_cmp.js"></script>
<script src="bignum_scan.js"></script>
<script src="bignum_str.js"></script>

<script>

var stdout;

function
run()
{
        stdout = document.getElementById("stdout");
	stdout.innerHTML = "";

	test_bignum_add();
	test_bignum_sub();
	test_bignum_mul();
	test_bignum_div();
	test_bignum_mod();
	test_bignum_pow();
	test_bignum_root();

	printline("ok");
}

function
test_bignum_add()
{
	printline("Testing bignum_add");

	for (i = 0; i < 10000; i++) {
		a = Math.floor(Math.random() * 16 * BIGM);
		b = Math.floor(Math.random() * 16 * BIGM);
		u = bignum_scan(String(a));
		v = bignum_scan(String(b));
		w = bignum_add(u, v);
		s = bignum_str(w);
		if (a + b != Number(s)) {
			printline("fail a " + a + " b " + b + " s " + s);
			break;
		}
	}
}

function
test_bignum_sub()
{
	printline("Testing bignum_sub");

	for (i = 0; i < 10000; i++) {
		a = Math.floor(Math.random() * 16 * BIGM);
		b = Math.floor(Math.random() * 16 * BIGM);
		if (a < b) {
			t = a;
			a = b;
			b = t;
		}
		u = bignum_scan(String(a));
		v = bignum_scan(String(b));
		w = bignum_sub(u, v);
		s = bignum_str(w);
		if (a - b != Number(s)) {
			printline("fail a " + a + " b " + b + " s " + s);
			break;
		}
	}
}

function
test_bignum_mul()
{
	printline("Testing bignum_mul");

	for (i = 0; i < 10000; i++) {
		a = Math.floor(Math.random() * 16 * BIGM);
		b = Math.floor(Math.random() * BIGM / 16);
		u = bignum_scan(String(a));
		v = bignum_scan(String(b));
		w = bignum_sub(u, v);
		s = bignum_str(w);
		if (a - b != Number(s)) {
			printline("fail a " + a + " b " + b + " s " + s);
			break;
		}
	}
}

function
test_bignum_div()
{
	printline("Testing bignum_div");

	for (i = 0; i < 10000; i++) {
		a = Math.floor(Math.random() * 16 * BIGM);
		b = Math.floor(Math.random() * BIGM / 16);
		u = bignum_scan(String(a));
		v = bignum_scan(String(b));
		w = bignum_div(u, v);
		s = bignum_str(w);
		if (Math.floor(a / b) != Number(s)) {
			printline("fail a " + a + " b " + b + " s " + s);
			break;
		}
	}
}

function
test_bignum_mod()
{
	printline("Testing bignum_mod");

	for (i = 0; i < 10000; i++) {
		a = Math.floor(Math.random() * 16 * BIGM);
		b = Math.floor(Math.random() * BIGM / 16);
		u = bignum_scan(String(a));
		v = bignum_scan(String(b));
		w = bignum_mod(u, v);
		s = bignum_str(w);
		if (a % b != Number(s)) {
			printline("fail a " + a + " b " + b + " s " + s);
			break;
		}
	}
}

function
test_bignum_pow()
{
	printline("Testing bignum_pow");

	for (i = 0; i < 10000; i++) {
		a = Math.floor(Math.random() * 100); // 100^7 < 2^48
		b = Math.floor(Math.random() * 8);
		u = bignum_scan(String(a));
		v = bignum_scan(String(b));
		w = bignum_pow(u, v);
		s = bignum_str(w);
		if (Math.pow(a, b) != Number(s)) {
			printline("fail a " + a + " b " + b + " s " + s);
			break;
		}
	}
}

function
test_bignum_root()
{
	printline("Testing bignum_root");

	for (a = 0; a < 13; a++)
		for (b = 1; b < 13; b++) {
			u = bignum_scan(String(a));
			v = bignum_scan(String(b));
			w = bignum_pow(u, v);
			w = bignum_root(w, v);
			if (w == null) {
				printline("fail a=" + a + " b=" + b);
				break;
			}
			s = bignum_str(w);
			if (a != Number(s)) {
				printline("fail a=" + a + " b=" + b + " s=" + s);
				break;
			}
		}
}

function
printline(s)
{
	stdout.innerHTML += s + "<br>";
}
</script>

<button onclick="run()" style="font-size:20pt">Run</button>

<p>
<div id="stdout"></div>

</body>
</html>
