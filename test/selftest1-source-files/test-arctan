"Testing arctan"

clear

check(arctan(-y,x) == -arctan(y,x))

check(infixform(arctan(0,0))="arctan(0,0)")

check(infixform(arctan(x))="arctan(x,1)")

check(arctan(1,1)=pi/4)
check(arctan(1,-1)=3*pi/4)
check(arctan(-1,1)=-pi/4)
check(arctan(-1,-1)=-3*pi/4)

check(arctan(0,3)=0)
check(arctan(0,-3)=pi)
check(arctan(3,0)=pi/2)
check(arctan(-3,0)=-pi/2)

check(arctan(3,3)=pi/4)
check(arctan(3,-3)=3*pi/4)
check(arctan(-3,3)=-pi/4)
check(arctan(-3,-3)=-3*pi/4)

check(infixform(arctan(2,4))="arctan(1,2)")
check(infixform(arctan(2,-4))="arctan(1,-2)")
check(infixform(arctan(-2,4))="-arctan(1,2)")
check(infixform(arctan(-2,-4))="-arctan(1,-2)")

check(infixform(arctan(1/2))="arctan(1,2)")

for(y,-18,18,for(x,-18,18,
  d = float(arctan(y/6,x/6)) - arctan(float(y/6),float(x/6)),
  check(abs(d) < 1.0 10^(-6))
))
